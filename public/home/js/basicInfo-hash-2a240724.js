(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'");}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){var Post=require("./../lib/post.js");var DateList=require("./../lib/DateList.js");
var Utility=require("./../lib/Utility.js");var AjaxHandler=require("./../lib/AjaxHandler.js");var _=require("./../lib/underscore/underscore.js");var dialog=require("./../ui/dialog.js");require("./../lib/userIcon.js");require("./../lib/smartdropdown.js");var post=Post.post,dateList=new DateList.DateList,Utility=Utility.Utility,AjaxHandler=AjaxHandler.AjaxHandler;var isIE=/msie/i.test(navigator.userAgent);var integrityWidth=90;var classNames={tooltipsWarning:"ui-tooltips.warning",tooltipsInfo:"ui-tooltips.info",
inputError:"input-error"};var patterns={pureNumberic:/[0-9]+/,illegalNickName:/([^A-Za-z0-9\u4e00-\u9fa5])+/,areaCode:/^[0][0-9]{2,3}$/,withoutAreaCodePhone:/^[0-9]{5,10}$/,withAreaCodePhone:/^[0-9]{5,10}$/,email:/^\w+[-\.\w]*@[A-Za-z0-9]+(\.)[\.\w\-]+$/,mobile:/^[1-9]{1}[0-9]+$/};window.myitoken="";var BasicInfo=function(){this.$tabs=$(".account > .accountTabs > .tab");this.$tabContents=$(".account > .accountContent > .tab-content");this.$accountBasicinfo=$(".accountBasicinfo");var $aci=this.$accountBasicinfo;
this.$resetBtn=$aci.find(".reset-info");this.$submitInfoBtn=$aci.find("#submitInfoBtn");this.$contentLoading=$aci.find(".contentLoading");this.$contentWarning=$aci.find(".contentWarning");this.$itemsContent=$aci.find(".itemsContent");this.$mobileRow=$aci.find("#mobileRow");this.$successNotice=$("#success-notice");this.$birthdayText=$("#basicBirthdayText");this.$activeTabName=$("#activeTabName");this.$birthdauUpdate=$("#birthdauUpdate");this.userHead={avatar:$aci.find(".userPic"),userName:$aci.find(".userName"),
integrity:$aci.find(".u-profile > i"),ratePerfect:$aci.find("#ratePerfect")};this.controls={nickname:$aci.find('input[name="nickname"]'),gender:$aci.find('input[name="gender"]'),birthday:$aci.find('input[name="birthday"]'),mobile:$aci.find('input[name="mobile"]'),areaCode:$aci.find('input[name="areaCode"]'),telephone:$aci.find('input[name="telephone"]'),provinceId:$aci.find('input[name="provinceId"]'),cityId:$aci.find('input[name="cityId"]'),countryId:$aci.find('input[name="countryId"]'),address:$aci.find('input[name="address"]'),
email:$aci.find('input[name="email"]')};this.mockRadio={radioGender:$aci.find(".radio-gender"),maleGender:$aci.find("#maleGender"),femaleGender:$aci.find("#femaleGender")};this.mockDropDown={year:$aci.find("#dlYear"),month:$aci.find("#dlMonth"),day:$aci.find("#dlDay"),province:$aci.find("#dlProvince"),city:$aci.find("#dlCity"),district:$aci.find("#dlDistrict"),country:$aci.find("#dlCountry")};this.$areaDropDowns=$aci.find(".address-item .ui-dropdown");this.$birthdayYear=this.mockDropDown.year.find('input[type="hidden"]');
this.$birthdayMonth=this.mockDropDown.month.find('input[type="hidden"]');this.$birthdayDay=this.mockDropDown.day.find('input[type="hidden"]');this.errors={};this.addressAreaData=[];this.fullNameData=null;this.isDirectly="0";this.oldIsDirectly="0";this.areaNames=[];this.firstLoad=true;this.submitted=false};BasicInfo.prototype={getBasicInfoData:function(callback){var _this=this;$.getJSON("//myi.vip.com/api/account/base_info",function(resp){AjaxHandler.handle302(resp);if(resp.code==200){_this.oldBasicInfoData=
resp.data;callback&&callback(resp)}else _this.loadFailedBasicContent()}).fail(function(){_this.loadFailedBasicContent()})},parseBirthday:function(birthday){var date=birthday.split("-");return{year:date[0],month:date[1],day:date[2]}},getAreaData:function(areaid,options){if(typeof areaid==="undefined")return;$.ajax({url:"//gensvr-n.vip.com/address/address?areaid="+(areaid?areaid:""),dataType:"jsonp",beforeSend:options.beforeSend,success:options.success,error:options.error,complete:options.complete})},
displayAvatarInfo:function(){var _this=this;$.getJSON("//myi.vip.com/api/account/extra_info",function(resp){var data=resp.data;AjaxHandler.handle302(resp);if(data){if(data.image_url)_this.userHead.avatar.find(" > img").attr("src",data.image_url);if(data.check_status==2)$(".J_avatar_fali_tip").removeClass("hidden");_this.displayIntegrityRate(data.profile_integrity)}})},displayBasicInfo:function(){var _this=this;this.getBasicInfoData(function(info){var baseInfo=info.data;if(baseInfo==null||baseInfo===
undefined)baseInfo={};baseInfo["registerByMobile"]=_this.isRegisterByMobile(baseInfo.userName);_this.bindBasicInfoData(baseInfo)})},isRegisterByMobile:function(userName){if(patterns.mobile.test(userName))return true;else return false},bindBasicInfoData:function(baseInfo){var _this=this;var date=null;this.userHead.userName.text(baseInfo.userName);this.mockRadio.radioGender.removeClass("active");if(baseInfo.gender!==undefined&&(baseInfo.gender!=null&&baseInfo.gender!==""))this.mockRadio.radioGender.filter('[data-value="'+
baseInfo.gender+'"]').addClass("active");if(baseInfo.birthday!==undefined&&(baseInfo.birthday!=null&&baseInfo.birthday!==""))date=this.parseBirthday(baseInfo.birthday);this.resetBirthdayDropDown(date,baseInfo.isAllowUpdateBirthday);$.each(baseInfo,function(key,value){if(_this.controls[key])if(key==="nickname"&&(value==null||value===""))_this.controls[key].val("\u552f\u54c1\u4f1a\u4f1a\u5458");else if(key=="bindEmail"||key=="email")if(baseInfo.bindEmail&&baseInfo.bindEmail==""||baseInfo.bindEmail==
undefined){$(".J_email_box").addClass("hidden");$(".J_email_input_box").removeClass("hidden");_this.controls["email"].val("")}else{$(".J_email_box").addClass("hidden");$(".J_email_txt_box").removeClass("hidden");$(".J_email_txt").html(baseInfo.bindEmail)}else _this.controls[key].val(value)});_this.handleMobileState(baseInfo);if(this.addressAreaData.length>0)this.renderAreaDropDownFromCache(this.addressAreaData);else this.bindAddressArea(baseInfo)},handleMobileState:function(baseInfo){var _this=this;
$.getJSON("//myi.vip.com/jsonp/api/phone/phone_safe_number",function(resp){var mobile=resp.data;if(mobile){_this.$mobileRow.find(".mobile-number").text(mobile).removeClass("hidden");_this.$mobileRow.find(".mobile-verified").removeClass("hidden");_this.controls.mobile.val(mobile)}else if(baseInfo.isRegisterByMobile){_this.$mobileRow.find(".mobile-number").text(mobile).removeClass("hidden");_this.$mobileRow.find(".button").removeClass("hidden");_this.controls.mobile.val(mobile)}else{_this.$mobileRow.find(".ui-input").removeClass("hidden");
_this.$mobileRow.find(".button").removeClass("hidden")}})},arrayUniquel:function(array){var newArray=[];var array_length=array.length;for(var i=0;i<array_length;i++)if($.inArray(array[i],newArray)==-1)newArray.push(array[i]);return newArray},bindAddressArea:function(baseInfo){var _this=this;var provinceId,$addressArea;var areaCallback=function(areaid){$.get("//gensvr-n.vip.com/address/address?areaid="+areaid,function(resp){var tempInfo=resp.info;var tempName=tempInfo.name;var tempFullName=tempInfo.full_name;
_this.fullNameData=tempInfo.full_name;if(tempName.indexOf("\u6211\u4e0d\u6e05\u695a")>-1){tempFullName=tempFullName.replace(".\u6211\u4e0d\u6e05\u695a","");tempFullName+="."+tempName}_this.areaNames=_this.arrayUniquel(tempFullName.split("."));_this.showBasicContent();if(_this.areaNames&&_this.areaNames.length>0)$.get("//gensvr-n.vip.com/address/address?areaid=",function(provinceData){_this.addAreaDropDownOptions(provinceData.list,_this.mockDropDown.province);_this.mockDropDown.province.smartdropdown("selected",
_this.areaNames[0])},"jsonp").fail(function(){_this.loadFailedBasicContent()})},"jsonp").fail(function(){_this.loadFailedBasicContent()})};if(baseInfo.countryId&&parseInt(baseInfo.countryId)>0)areaCallback(baseInfo.countryId);else{provinceId=baseInfo.provinceId;if(baseInfo.provinceId===undefined||baseInfo==null)provinceId="0";$addressArea=this.mockDropDown.province.add(this.mockDropDown.city).add(this.mockDropDown.district).add(this.mockDropDown.country);$addressArea.removeClass("hidden");this.resetMockDropDown($addressArea);
$.get("//gensvr-n.vip.com/address/address?areaid=",function(resp){var provinceList,items;_this.addAreaDropDownOptions(resp.list,_this.mockDropDown.province);_this.mockDropDown.province.find(".text").text("\u7701/\u76f4\u8f96\u5e02");if(parseInt(provinceId)>0)_this.mockDropDown.province.smartdropdown("selected",provinceId);_this.firstLoad=false;_this.showBasicContent()},"jsonp")}},renderAreaDropDownFromCache:function(areaData){var length=areaData.length,addressList=[],$filteredDropDowns,$tempDropdown;
$filteredDropDowns=this.$areaDropDowns.slice(0,length);this.$areaDropDowns.slice(length).addClass("hidden");this.resetMockDropDown(this.$areaDropDowns);for(var i=0;i<length;i++){$tempDropdown=$filteredDropDowns.eq(i);this.addAreaDropDownOptions(areaData[i].data,$tempDropdown);$tempDropdown.smartdropdown("selected",areaData[i].id,true);$tempDropdown.find(".text").removeClass("c_999");$tempDropdown.removeClass("hidden")}},getDataFromAreaOptions:function(){var optionsList=[],$filteredDropDowns,length;
$filteredDropDowns=this.$areaDropDowns.not(".hidden");length=$filteredDropDowns.length;function getOptions($dropdown){var list=[],$me;var $options=$dropdown.find(".options > .item");$options.each(function(){$me=$(this);list.push({id:$me.attr("data-value"),name:$me.attr("data-text")})});return list}for(var i=0;i<length;i++)optionsList.push({"id":$filteredDropDowns.eq(i).smartdropdown("getValue"),"data":getOptions($filteredDropDowns.eq(i))});return optionsList},showBasicContent:function(){this.$contentLoading.hide();
this.$contentWarning.hide();this.$itemsContent.show()},loadFailedBasicContent:function(){this.$contentLoading.hide();this.$contentWarning.show();this.$itemsContent.hide()},displayIntegrityRate:function(integrity){var rate=integrity/100*integrityWidth;var fixRate=rate<20?20:rate;this.userHead.integrity.css("width",fixRate+"px").text(integrity+"%");this.userHead.integrity.removeClass("bc_ee0000 bc_f09513 bc_f19413 bc_3bad00");if(integrity<=5)this.userHead.integrity.addClass("bc_ee0000");else if(integrity<=
50)this.userHead.integrity.addClass("bc_f09513");else if(integrity<100)this.userHead.integrity.addClass("bc_f19413");else this.userHead.integrity.addClass("bc_3bad00");if(integrity===100)this.userHead.ratePerfect.show();else this.userHead.ratePerfect.hide()},resetBirthdayDropDown:function(date,status){var _this=this;var yearOptions=this.generateOptions(dateList.dateRange.yearStart,dateList.dateRange.yearEnd,true);var monthOptions=this.generateOptions(dateList.dateRange.monthStart,dateList.dateRange.monthEnd);
var dayOptons=this.generateOptions(dateList.dateRange.dayStart,dateList.dateRange.dayEnd);var text;this.resetMockDropDown(this.mockDropDown.year);this.resetMockDropDown(this.mockDropDown.month);this.resetMockDropDown(this.mockDropDown.day);this.mockDropDown.year.smartdropdown("append",yearOptions);this.mockDropDown.month.smartdropdown("append",monthOptions);this.mockDropDown.day.smartdropdown("append",dayOptons);if(status)this.$birthdauUpdate.removeClass("hidden");if(date){this.mockDropDown.year.smartdropdown("selected",
date.year);this.mockDropDown.month.smartdropdown("selected",parseInt(date.month));this.mockDropDown.day.smartdropdown("selected",parseInt(date.day));this.mockDropDown.year.addClass("hidden");this.mockDropDown.month.addClass("hidden");this.mockDropDown.day.addClass("hidden");this.mockDropDown.year.siblings(".toLeft").addClass("hidden");text=date.year+"-"+parseInt(date.month)+"-"+parseInt(date.day);this.$birthdayText.text(text).removeClass("hidden")}else{this.mockDropDown.year.removeClass("hidden");
this.mockDropDown.month.removeClass("hidden");this.mockDropDown.day.removeClass("hidden");this.mockDropDown.year.find('input[type="hidden"]').val("");this.mockDropDown.year.find(".text").text("\u8bf7\u9009\u62e9").addClass("c_999");this.mockDropDown.month.find('input[type="hidden"]').val("");this.mockDropDown.month.find(".text").text("\u8bf7\u9009\u62e9").addClass("c_999");this.mockDropDown.day.find('input[type="hidden"]').val("");this.mockDropDown.day.find(".text").text("\u8bf7\u9009\u62e9").addClass("c_999")}},
showBirthdaySelecter:function(){$().add(this.$birthdayText).add(this.$birthdauUpdate).addClass("hidden");$().add(this.mockDropDown.year).add(this.mockDropDown.month).add(this.mockDropDown.day).removeClass("hidden")},resetMockDropDown:function($dropdowns){$dropdowns.each(function(){var $ddl=$(this);$ddl.smartdropdown("reset");var placeholder=$ddl.attr("data-placeholder");if(placeholder&&placeholder!=="")$ddl.find(" > .text").text(placeholder);$ddl.removeClass(classNames.inputError);$ddl.find(".text").addClass("c_999")})},
reCalcDayDropDown:function(year,month){var fixMonth=parseInt(month);var fixYear=parseInt(year);var value=parseInt(this.mockDropDown.day.smartdropdown("getValue"));var resetValue,dayOptons;dateList.fixDayRange(fixYear,fixMonth);dayOptons=this.generateOptions(dateList.dateRange.dayStart,dateList.dateRange.dayEnd);this.mockDropDown.day.smartdropdown("render",dayOptons);if(value>dateList.dateRange.dayEnd){resetValue="";this.mockDropDown.day.smartdropdown("selected",resetValue);this.mockDropDown.day.find(".text").text("\u8bf7\u9009\u62e9")}else{resetValue=
value;this.mockDropDown.day.smartdropdown("selected",resetValue)}},generateOptions:function(start,end,reverse){var items=[];if(reverse)for(var i=end;i>=start;i--)items.push({text:i,value:i});else for(var i=start;i<=end;i++)items.push({text:i,value:i});return items},initAreaDropDown:function(areaid,$dropdown,defaultValue,callback){var _this=this;this.getAreaData(areaid,{beforeSend:function(){$dropdown.find(".options").html('<div class="s-loading small"><span>\u8bf7\u7a0d\u540e</span></div>')},success:function(resp){var $nextAll=
$dropdown.nextAll(".ui-dropdown");if(areaid&&$dropdown.attr("id")==="dlCity"){$nextAll.removeClass("hidden");if(resp.info&&resp.info.is_directly==="1"){_this.isDirectly="1";_this.oldIsDirectly="1";_this.mockDropDown.country.addClass("hidden")}else{_this.isDirectly="0";_this.oldIsDirectly="0"}}if($dropdown.length>0)switch(resp.list.length){case 0:$dropdown.addClass("hidden");$dropdown.smartdropdown("hide");break;case 1:if(resp.list[0].id==="0"){$dropdown.addClass("hidden");$dropdown.smartdropdown("hide")}else _this.fillAreaData($dropdown,
resp,defaultValue);break;default:_this.fillAreaData($dropdown,resp,defaultValue)}callback&&callback(resp)},error:function(){_this.resetMockDropDown($dropdown)},complete:function(){$dropdown.find(".options .s-loading").remove()}})},setAreaDropPlaceholder:function(defaultValue){if(!defaultValue)if(this.isDirectly==="1"){this.mockDropDown.city.find(".text").text("\u533a/\u53bf");this.mockDropDown.district.find(".text").text("\u4e61\u9547/\u8857\u9053")}else{this.mockDropDown.city.find(".text").text("\u5e02");
this.mockDropDown.district.find(".text").text("\u533a/\u53bf")}},fillAreaData:function($dropdown,resp,defaultValue){var $tempItem;$dropdown.removeClass("hidden");if(resp.list)this.addAreaDropDownOptions(resp.list,$dropdown);if(defaultValue){$dropdown.smartdropdown("selected",defaultValue);$dropdown.find(".text").removeClass("c_999")}else $dropdown.find(".text").addClass("c_999")},handleAreaCompleted:function(){if(this.firstLoad){this.areaNames=[];this.addressAreaData=this.getDataFromAreaOptions();
this.showBasicContent();this.firstLoad=false}},addAreaDropDownOptions:function(list,$dropdown){var options="",fixItems,unknownAddress,mapItems,defaultItem,$items,itemLength;fixItems=_.filter(list,function(obj){return parseInt(obj.id)>0&&obj.name!=="\u6211\u4e0d\u6e05\u695a"});unknownAddress=_.find(list,function(obj){return obj.name==="\u6211\u4e0d\u6e05\u695a"});if(unknownAddress)fixItems.push(unknownAddress);mapItems=_.map(fixItems,function(obj){return{text:obj.name,value:obj.id}});itemLength=mapItems.length;
$dropdown.smartdropdown("render",mapItems);$items=$dropdown.find(".item");if(unknownAddress)$dropdown.find(".options > span").eq(0).before('<p class="highlight">*\u5982\u4e0d\u6e05\u695a\uff0c\u53ef\u9009\u62e9\u201c\u6211\u4e0d\u6e05\u695a\u201d\u3002</p>')},setDropDownPlaceHolder:function($dropdown,changed){var placeholder;if(changed===true)placeholder="data-changed-placeholder";else placeholder="data-placeholder";var phValue=$dropdown.attr(placeholder);if(phValue&&phValue!=="")$dropdown.find("> .text").text(phValue)},
addErrorMark:function($ctrl,message){var name=$ctrl.attr("name");$ctrl.addClass(classNames.inputError);$ctrl.siblings("."+classNames.tooltipsInfo).hide();this.errors[name]=message},removeErrorMark:function($ctrl){var name=$ctrl.attr("name");this.errors[name]="";$ctrl.removeClass(classNames.inputError)},showError:function($ctrl,message){this.addErrorMark($ctrl,message);$ctrl.siblings("."+classNames.tooltipsWarning).find("span").html(message).end().show()},removeError:function($ctrl){this.removeErrorMark($ctrl);
$ctrl.siblings("."+classNames.tooltipsWarning).find("span").html("").end().hide()},activeGender:function(e){var radio=$(e.target);var value=radio.attr("data-value");this.mockRadio.radioGender.removeClass("active");this.mockRadio.radioGender.filter(radio).addClass("active");this.controls.gender.val(value)},showNickNameTips:function(){var $nickname=this.controls.nickname;this.hideErrorTips($nickname);$nickname.siblings("."+classNames.tooltipsInfo).show()},showErrorTips:function($ctrl,message){$ctrl.siblings("."+
classNames.tooltipsWarning).find("span").html(message).end().show()},hideErrorTips:function($ctrl){$ctrl.removeClass(classNames.inputError).siblings("."+classNames.tooltipsWarning).hide()},hideInfoTips:function($ctrl){$ctrl.siblings("."+classNames.tooltipsInfo).hide()},showInfoTips:function($ctrl){$ctrl.siblings("."+classNames.tooltipsInfo).show()},validateNickName:function(){var valueArray,length,num=0,wordLength=0;var $nickname=this.controls.nickname;if($nickname&&$nickname.length){var value=$.trim($nickname.val());
$nickname.siblings("."+classNames.tooltipsInfo).hide();if(value===""){this.showError($nickname,"\u8bf7\u8f93\u5165\u6635\u79f0");return false}else{valueArray=value.split("");length=valueArray.length;for(var i=0;i<length;i++)if(patterns.pureNumberic.test(valueArray[i]))num++;if(length===num){this.showError($nickname,"\u4e0d\u80fd\u8bbe\u7f6e\u7eaf\u6570\u5b57\uff0c\u8bf7\u66f4\u6362~\uff01~");return false}wordLength=length+Utility.checkChineseLength(value);if(wordLength<4||wordLength>20){this.showError($nickname,
"\u6635\u79f0\u683c\u5f0f\u4e0d\u6b63\u786e");return false}else if(!patterns.illegalNickName.test(value)){this.removeError($nickname);return true}else{this.showError($nickname,"\u6635\u79f0\u683c\u5f0f\u4e0d\u6b63\u786e");return false}}}else return true},validateBrithday:function(){if(this.mockDropDown.year.hasClass("hidden")){this.removeError(this.mockDropDown.day);return true}var year=this.$birthdayYear.val(),month=this.$birthdayMonth.val(),day=this.$birthdayDay.val(),fixYear,fixMonth,fixDay;var d,
currentYear,currentMonth,currentDay;d=new Date;currentYear=d.getFullYear();currentMonth=d.getMonth()+1;currentDay=d.getDate();fixYear=year===""?0:parseInt(year);fixMonth=month===""?0:parseInt(month);fixDay=day===""?0:parseInt(day);if(year===""){this.showError(this.mockDropDown.year,"\u8bf7\u586b\u5199\u60a8\u7684\u5e74\u4efd");return false}else this.removeError(this.mockDropDown.year);if(month===""){this.showError(this.mockDropDown.month,"\u8bf7\u586b\u5199\u60a8\u7684\u6708\u4efd");return false}else this.removeError(this.mockDropDown.month);
if(day===""){this.showError(this.mockDropDown.day,"\u8bf7\u586b\u5199\u60a8\u7684\u751f\u65e5");return false}else this.removeError(this.mockDropDown.day);if(fixYear>currentYear||(fixYear===currentYear&&fixMonth>currentMonth||fixYear===currentYear&&(fixMonth===currentMonth&&fixDay>currentDay))){this.showError(this.mockDropDown.day,"\u751f\u65e5\u65e5\u671f\u5927\u4e8e\u5f53\u524d\u65e5\u671f");return false}else{this.removeError(this.mockDropDown.day);return true}},showPhoneNumberTips:function(){var areacode=
$.trim(this.controls.areaCode.val());var telephone=$.trim(this.controls.telephone.val());this.controls.areaCode.add(this.controls.telephone).removeClass(classNames.inputError).siblings("."+classNames.tooltipsWarning).hide();this.controls.telephone.siblings("."+classNames.tooltipsInfo).show()},validateAreaCode:function(){var valid=true;var errorMsg="\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u7535\u8bdd\u53f7\u7801";var areacode=$.trim(this.controls.areaCode.val());this.hideInfoTips(this.controls.areaCode);
if(areacode==="")this.removeErrorMark(this.controls.areaCode);else if(patterns.areaCode.test(areacode))this.removeErrorMark(this.controls.areaCode);else{this.addErrorMark(this.controls.areaCode,errorMsg);valid=false}if(!valid)this.showErrorTips(this.controls.areaCode,errorMsg);return valid},validateTelephone:function(){var valid=true;var errorMsg="\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u7535\u8bdd\u53f7\u7801";var areacode=$.trim(this.controls.areaCode.val());var telephone=$.trim(this.controls.telephone.val());
this.hideInfoTips(this.controls.telephone);if(areacode==="")if(telephone==="")this.removeErrorMark(this.controls.telephone);else if(patterns.withoutAreaCodePhone.test(telephone))this.removeErrorMark(this.controls.telephone);else{this.addErrorMark(this.controls.telephone,errorMsg);valid=false}else{if(patterns.areaCode.test(areacode))this.removeErrorMark(this.controls.areaCode);else{this.addErrorMark(this.controls.areaCode,errorMsg);valid=false}if(patterns.withAreaCodePhone.test(telephone))this.removeErrorMark(this.controls.telephone);
else{this.addErrorMark(this.controls.telephone,errorMsg);valid=false}}if(!valid)this.showErrorTips(this.controls.telephone,errorMsg);return valid},showAddressTips:function(){var value=this.controls.address.val();this.hideErrorTips(this.controls.address);if(value==="")this.showInfoTips(this.controls.address);else this.hideInfoTips(this.controls.address)},validateAddress:function(){var value=$.trim(this.controls.address.val());var $filteredDropDowns=this.$areaDropDowns.not(".hidden");var lastId=$filteredDropDowns.last().smartdropdown("getValue");
var $me,tempValue;this.hideInfoTips(this.controls.address);$filteredDropDowns.each(function(){$me=$(this);tempValue=$me.smartdropdown("getValue");if(tempValue==="")$me.addClass(classNames.inputError);else $me.removeClass(classNames.inputError)});if(lastId===""||value===""){this.showError(this.controls.address,"\u8bf7\u586b\u5199\u5b8c\u6574\u7684\u5730\u5740\u4fe1\u606f");this.calcTooltipsPosition(this.controls.address);return false}if(value.length>30){this.showError(this.controls.address,"\u6700\u5927\u957f\u5ea6\u4e3a30\u4e2a\u5b57\u7b26");
this.calcTooltipsPosition(this.controls.address);return false}else{this.removeError(this.controls.address);return true}},calcTooltipsPosition:function($ctrl){var offsetLeft=$ctrl[0].offsetLeft,$err=$ctrl.siblings(".warning"),ow=$ctrl.outerWidth(true);$err.hide();$err.css({"position":"absolute","left":offsetLeft+ow}).show()},validateEmail:function(){var email=$.trim(this.controls.email.val());this.hideInfoTips(this.controls.email);if(email.length>50){this.showError(this.controls.email,"\u90ae\u7bb1\u6700\u5927\u957f\u5ea6\u4e3a50\u4e2a\u5b57\u7b26");
return false}if(patterns.email.test(email)){this.removeError(this.controls.email);return true}else{this.showError(this.controls.email,"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u90ae\u7bb1\u8d26\u53f7");return false}},validateGender:function(){var $genderVal=$("#J_gender_options");if($genderVal.attr("value")==0||$genderVal.attr("value")==1){this.removeError(this.controls.gender);return true}this.showError(this.controls.gender,"\u8bf7\u9009\u62e9\u60a8\u7684\u6027\u522b");return false},submitBaiscInfo:function(e){e.preventDefault();
if(!myitoken){this.showDialog("warning","\u8bf7\u6c42\u63d0\u4ea4\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\u3002");return false}if(!this.$submitInfoBtn.hasClass("disabled")){var _this=this;var data=[],validateList=[],$filteredDropDowns,dropdownLength,cityId,countryId;var year,month,day;validateList.push(this.validateNickName());validateList.push(this.validateGender());validateList.push(this.validateBrithday());validateList.push(this.validateTelephone());validateList.push(this.validateAddress());
var invalid=_.contains(validateList,false);if(!invalid){this.$submitInfoBtn.addClass("disabled");if(!this.mockDropDown.year.hasClass("hidden")){year=this.$birthdayYear.val();month=this.$birthdayMonth.val();day=this.$birthdayDay.val();if(month!==""&&month.length===1)month="0"+month;if(day!==""&&day.length===1)day="0"+day;this.controls.birthday.val(year+"-"+month+"-"+day)}$filteredDropDowns=this.$areaDropDowns.filter(":not(.hidden)");dropdownLength=$filteredDropDowns.length;countryId=$filteredDropDowns.eq(dropdownLength-
1).smartdropdown("getValue");if(dropdownLength>2)cityId=$filteredDropDowns.eq(dropdownLength-2).smartdropdown("getValue");else cityId=countryId.substring(0,9);if(cityId.length===12)cityId=cityId.substring(0,9);this.controls.cityId.val(cityId);this.controls.countryId.val(countryId);data=_.map(this.controls,function(ctrl,key){return{"name":key,"value":$.trim(ctrl.val())}});data.push({"name":"myitoken","value":myitoken});$.post("//myi.vip.com/api/account/base_info",data,function(resp){AjaxHandler.handle302(resp);
var smartYear,smartMonth,smartDay;if(resp.code===200){_this.submitted=true;if(!_this.mockDropDown.year.hasClass("hidden")){_this.mockDropDown.year.addClass("hidden");smartYear=_this.$birthdayYear.val()}if(!_this.mockDropDown.month.hasClass("hidden")){_this.mockDropDown.month.addClass("hidden");smartMonth=_this.$birthdayMonth.val()}if(!_this.mockDropDown.day.hasClass("hidden")){_this.mockDropDown.day.addClass("hidden");smartDay=_this.$birthdayDay.val();_this.mockDropDown.year.siblings(".toLeft").addClass("hidden");
_this.$birthdayText.text(smartYear+"-"+parseInt(smartMonth)+"-"+parseInt(smartDay)).removeClass("hidden")}_this.resetBasicInfoData();_this.addressAreaData=_this.getDataFromAreaOptions();_this.oldIsDirectly=_this.isDirectly;_this.displayAvatarInfo();_this.showDialog("success","\u8d44\u6599\u4fdd\u5b58\u6210\u529f",function(){if(resp.msg==="1")_this.showVMarkNotice()})}else if(resp.code==600){_this.showDialog("warning","\u6635\u79f0\u542b\u6709\u975e\u6cd5\u8bcd\u6c47\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165");
_this.controls.nickname.addClass("input-error")}else _this.showDialog("warning","\u8d44\u6599\u4fdd\u5b58\u5931\u8d25")},"json").fail(function(){_this.showDialog("warning","\u8d44\u6599\u4fdd\u5b58\u5931\u8d25")}).always(function(){_this.$submitInfoBtn.removeClass("disabled")})}}},showDialog:function(type,msg,callback){dialog.show({title:"",type:type,msg:msg,mask:true,onCloseButton:callback,buttons:[{text:"\u786e\u5b9a",type:"primary",size:"medium",event:function(){this.close()}}]})},showVMarkNotice:function(){var _this=
this;this.$successNotice.height(0).removeClass("hidden");this.$successNotice.animate({"marginTop":10,"height":30,"opacity":1},500);setTimeout(function(){_this.$successNotice.animate({"marginTop":0,"height":0,"opacity":0},500,function(){_this.$successNotice.addClass("hidden")})},6E3)},resetBasicInfoData:function(){var _this=this;_.each(this.controls,function(value,key){_this.oldBasicInfoData[key]=value.val()})},reset:function(){this.submitted=false;this.isDirectly=this.oldIsDirectly;this.bindBasicInfoData(this.oldBasicInfoData);
this.$accountBasicinfo.find(":text").removeClass(classNames.inputError);this.$accountBasicinfo.find(".ui-tooltips").hide();$.each(this.mockDropDown,function(){$(this).removeClass(classNames.inputError)})},fixPlaceholderText:function($text,length){var text=$text.text();if(text.length>length)$text.text(text.substring(0,length)).attr("title",text);else $text.removeAttr("title")},initMockAddressDropDown:function(){var _this=this;this.mockDropDown.province.smartdropdown({itemTagName:"span",maxCount:30,
onChange:function(value,text){var $me=$(this);var $text=$me.find(".text");var $nextAll=$me.nextAll(".ui-dropdown");if(value!==""){$me.removeClass(classNames.inputError);$text.removeClass("c_999")}_this.fixPlaceholderText($text,8);_this.resetMockDropDown($nextAll);if(!_this.firstLoad)_this.mockDropDown.city.smartdropdown("show");_this.initAreaDropDown(value,_this.mockDropDown.city,_this.areaNames[1],function(){if(isIE){$text.text($text.text());_this.fixPlaceholderText($text,8)}if(!_this.firstLoad)_this.setAreaDropPlaceholder(_this.areaNames[1])})}});
this.mockDropDown.city.smartdropdown({itemTagName:"span",maxCount:30,onChange:function(value,text){var $me=$(this);var $text=$me.find(".text");var $nextAll=$me.nextAll(".ui-dropdown");if(value!==""){$me.removeClass(classNames.inputError);$text.removeClass("c_999")}_this.fixPlaceholderText($text,8);_this.resetMockDropDown($nextAll);if(!_this.firstLoad)_this.mockDropDown.district.smartdropdown("show");_this.initAreaDropDown(value,_this.mockDropDown.district,_this.areaNames[2],function(){if(_this.firstLoad){if(_this.areaNames.length===
2)_this.handleAreaCompleted()}else{if(_this.isDirectly==="1"&&_this.areaNames[2]===undefined)_this.mockDropDown.district.find(".text").text("\u4e61\u9547/\u8857\u9053");else _this.mockDropDown.district.find(".text").text("\u533a/\u53bf");_this.validateAreaDropDown(_this.mockDropDown.city)}})}});this.mockDropDown.district.smartdropdown({itemTagName:"span",maxCount:30,onChange:function(value,text){var $me=$(this);var $text=$me.find(".text");var $nextAll=$me.nextAll(".ui-dropdown");if(value!==""){$me.removeClass(classNames.inputError);
$text.removeClass("c_999")}_this.fixPlaceholderText($text,8);_this.resetMockDropDown($nextAll);if(!_this.firstLoad&&_this.isDirectly==="0")_this.mockDropDown.country.smartdropdown("show");_this.initAreaDropDown(value,_this.mockDropDown.country,_this.areaNames[3],function(){if(_this.firstLoad)_this.handleAreaCompleted();else _this.validateAreaDropDown(_this.mockDropDown.district)})}});this.mockDropDown.country.smartdropdown({itemTagName:"span",maxCount:30,onChange:function(value,text){var $me=$(this);
var $text=$me.find(".text");var $next=$me.next(".ui-dropdown");if(value!==""){$me.removeClass(classNames.inputError);$text.removeClass("c_999")}_this.fixPlaceholderText($text,8);if(!_this.firstLoad)_this.initAreaDropDown(value,$next,null,function(){if(!_this.firstLoad)_this.validateAreaDropDown(_this.mockDropDown.country)})}})},validateAreaDropDown:function($dropdown){var address=$.trim(this.controls.address.val());var $drops=this.$areaDropDowns.not(":hidden");if(address!=="")if($drops.last().is($dropdown))this.validateAddress()},
switchTabs:function(e){var $me=$(e.target);var index=this.$tabs.index($me);this.$tabs.removeClass("active");$me.addClass("active");this.$activeTabName.text($me.text());this.$tabContents.removeClass("active");this.$tabContents.eq(index).addClass("active")},initBirthdayDropDown:function(){var _this=this;this.mockDropDown.year.smartdropdown({onChange:function(value,text){var $text=$(this).find(".text");var month=_this.mockDropDown.month.smartdropdown("getValue");if(value!=="")$text.removeClass("c_999");
_this.reCalcDayDropDown(value,month);_this.validateBrithday()}});this.mockDropDown.month.smartdropdown({onChange:function(value,text){var $text=$(this).find(".text");var year=_this.mockDropDown.year.smartdropdown("getValue");if(value!=="")$text.removeClass("c_999");_this.reCalcDayDropDown(year,value);_this.validateBrithday()}});this.mockDropDown.day.smartdropdown({onChange:function(value,text){var $text=$(this).find(".text");if(value!=="")$text.removeClass("c_999");_this.validateBrithday()}})},checkThirdPartyLogin:function(){$.get("//myi.vip.com/api/account/checkThirdLoginOnly",
function(rtn){if(rtn&&rtn.code=="200")rtn.data?$(".J_login_setting").removeClass("hidden"):$(".J_login_setting").addClass("hidden");else $(".J_login_setting").addClass("hidden")})},get_verify_token:function(){var _url="//myi.vip.com/api/common/get_verify_token";$.get(_url,function(rtn){if(rtn.code==200)myitoken=rtn.myitoken||""})},init:function(){var _this=this;this.get_verify_token();this.initBirthdayDropDown();this.initMockAddressDropDown();this.displayAvatarInfo();this.displayBasicInfo();this.checkThirdPartyLogin();
this.$resetBtn.on("click",_.bind(this.reset,this));this.mockRadio.radioGender.on("click",_.bind(this.activeGender,this));this.mockRadio.radioGender.on("click",_.bind(this.validateGender,this));this.controls.nickname.on("focus",_.bind(this.showNickNameTips,this));this.controls.nickname.on("blur",_.bind(this.validateNickName,this));this.controls.areaCode.add(this.controls.telephone).on("focus",_.bind(this.showPhoneNumberTips,this));this.controls.areaCode.on("blur",_.bind(this.validateAreaCode,_this));
this.controls.telephone.on("blur",_.bind(this.validateTelephone,_this));this.controls.address.on("focus",_.bind(this.showAddressTips,this));this.controls.address.on("blur",_.bind(this.validateAddress,this));this.controls.email.on("blur",_.bind(this.validateEmail,this));this.controls.email.on("focus",function(){_this.hideErrorTips(_this.controls.email)});this.$submitInfoBtn.on("click",_.bind(this.submitBaiscInfo,this));this.$tabs.on("click",_.bind(this.switchTabs,this));this.$birthdauUpdate.find("a").on("click",
_.bind(this.showBirthdaySelecter,this))}};BasicInfo.prototype.constructor=BasicInfo;$(function(){(new BasicInfo).init()})},{"./../lib/AjaxHandler.js":2,"./../lib/DateList.js":3,"./../lib/Utility.js":4,"./../lib/post.js":6,"./../lib/smartdropdown.js":7,"./../lib/underscore/underscore.js":8,"./../lib/userIcon.js":9,"./../ui/dialog.js":11}],2:[function(require,module,exports){var AjaxHandler={handle302:function(resp){var url,data;if(typeof resp==="string")data=$.parseJSON(resp);else data=resp;if(data.code==
302){url=encodeURIComponent(window.location.href);window.location.href=data.data.replace(/src=.*/,"")+url;return false}}};module.exports.AjaxHandler=AjaxHandler},{}],3:[function(require,module,exports){var DateList=function(startYear,endYear,yearRange){var fixStartYear,fixEndYear,fixYearRange;var d=new Date;var year=d.getFullYear();fixYearRange=yearRange===undefined?99:yearRange;fixEndYear=endYear===undefined?year:endYear;if(startYear===undefined)fixStartYear=fixEndYear-fixYearRange;else fixStartYear=
startYear;this.dateRange={yearStart:fixStartYear,yearEnd:fixEndYear,monthStart:1,monthEnd:12,dayStart:1,dayEnd:31}};DateList.prototype={isLeapyear:function(year){if(year%4==0&&year%100!=0||year%100==0&&year%400==0)return true;return false},fixDayRange:function(currentYear,currentMonth){var leapYear=this.isLeapyear(currentYear);var dayEnd=31;switch(currentMonth){case 1:dayEnd=31;break;case 2:dayEnd=leapYear?29:28;break;case 3:dayEnd=31;break;case 4:dayEnd=30;break;case 5:dayEnd=31;break;case 6:dayEnd=
30;break;case 7:dayEnd=31;break;case 8:dayEnd=31;break;case 9:dayEnd=30;break;case 10:dayEnd=31;break;case 11:dayEnd=30;break;case 12:dayEnd=31;break}this.dateRange.dayEnd=dayEnd}};DateList.prototype.constructor=DateList;module.exports.DateList=DateList},{}],4:[function(require,module,exports){var Utility={checkChineseLength:function(input){var pattern=/[\u4e00-\u9fa5]{1}/g;var matches=input.match(pattern);if(matches==null)return 0;return matches.length}};module.exports.Utility=Utility},{}],5:[function(require,
module,exports){var tool={},panelTemplate={"defaultUi":'<div class="panel" {{id}} {{style}}>'+'<div class="background"></div>'+'<div class="content">{{content}}</div>'+'<a href="javascript:;" role="button" class="close">x</a>'+"</div>","Vui":'<div class="ui-dialog ui-dialog-large" {{id}} {{style}}>                                <div class="ui-dialog-inner">                                    <a href="javascript:;" role="button" class="ui-dialog-close vipFont close">\ue609</a>                                    <div class="ui-dialog-content">{{content}}</div>                                </div>                            </div>'};
function Panel(id,content,width,height,opt){this.opt=$.extend({},opt);this.id=id;this.content=content;this.width=width;this.height=height;this.template=this.opt.useVui?panelTemplate.Vui:panelTemplate.defaultUi;this.cover=$('<div class="vct-cover"></div>').css({"height":$(document).height()+"px"});this.closers=[];Panel.fn.items.push(this)}Panel.fn=Panel.prototype={"constructor":Panel,"display":false,"initPanel":function(){var that=this,_style,_content;_style=this.opt.useVui?"":'style="width:'+(this.width?
this.width+"px":"auto")+";height:"+(this.height?this.height+"px":"auto")+'"';this.template=this.template.replace("{{id}}",'id="'+(this.id||"")+'"').replace("{{content}}",this.content||"").replace("{{style}}",_style);this.self=$(this.template);$(document.body).append(this.self);this.self.find(".close").on("click",function(){that.hide()});_content=this.self.find(".content");if(!this.width&&!this.height)this.self.css({"width":_content.width()+30+"px","height":_content.height()+30+"px","left":($(document.body).width()-
(_content.width()+30))/2+"px","top":"50%"});else{this.self.css({"left":($(document).width()-this.width)/2,"top":"50%"});_content.css({"width":this.width-30+"px","height":this.height-30+"px"})}return this},"show":function(){var that=this,_style,_top;if(!that.self)that.initPanel();if(that.display){that.cover.css("min-height",$(document.body).height());return that}_top=$(document).scrollTop()+(window.screen.height-that.self.height())/2-50;that.self.css({"display":"block","z-index":tool.config.zindex*
2+1E3,"top":_top<100?100:_top+"px","visibility":"visible"}).removeClass("z-ui-dialog-out").addClass("z-ui-dialog-in");that.cover.css({"min-height":$(document.body).height(),"z-index":tool.config.zindex*2+999}).show().appendTo($("body"));tool.config.zindex++;tool.config.modal.hide();that.display=true;return that},"hide":function(isClean){if(!this.display)return this;for(var i=0;i<this.closers.length;i++)if(this.closers[i]()===false)return;this.cover.hide().remove();if(isClean)return $(this.id?"#"+
this.id:".panel").remove();$(this.id?"#"+this.id:".panel").css({"display":"none","visibility":"hidden"}).removeClass("z-ui-dialog-in").addClass("z-ui-dialog-out");this.display=false;tool.display();tool.config.zindex--;return this},"onClose":function(callback){this.closers.push(callback)},"clean":function(){if(!this.display)return this;this.self.remove();this.cover.remove();this.display=false;tool.display();tool.config.zindex--;return this},items:[],zindex:0};window.Panel=Panel;tool.config={count:0,
zindex:0,modal:$("#walletCode , #walletCode2").parent()};tool.display=function(){tool.config.modal.show()};tool.Panel=Panel;module.exports=tool},{}],6:[function(require,module,exports){var tool,config,Post,Ajax,manage;manage=function(){var _self=this,_rtn=function(url,data,callback,type){_self.post.apply(_self,arguments)};_rtn.ajax=function(){return _self.ajax.apply(_self,arguments)};_rtn.post=function(){return _self.post.apply(_self,arguments)};_rtn.get=function(){return _self.get.apply(_self,arguments)};
_rtn.error=function(){return _self.error.apply(_self,arguments)};_rtn.confirm=function(){return _self.confirm.apply(_self,arguments)};_rtn.alert=function(){return _self.alert.apply(_self,arguments)};_rtn.loading=function(){return _self.loading.apply(_self,arguments)};_rtn.error=function(){return _self.error.apply(_self,arguments)};_rtn.uncover=function(){return _self.uncover.apply(_self,arguments)};_rtn.close=function(){return _self.close.apply(_self,arguments)};return _rtn};manage.fn=manage.prototype=
{"ajax":function(url,data,callback,type,opts){if(!url||typeof url!=="string")return false;else if(typeof data=="function"){if(callback){opts=type;type=callback}callback=data;data={}}return new Post(url,data,callback,type||"get",opts)},"post":function(url,data,callback,opts){this.ajax(url,data,callback,"post",opts)},"get":function(url,data,callback,opts){this.ajax(url,data,callback,"get",opts)},"error":function(errors){if(typeof errors=="function")errors=[errors];else if(!(errors instanceof Array))return false;
config.errors=config.errors.concat(errors)},confirm:function(title,str){this.alert(title,str,true);return this},"alert":function(title,str,isSuccess,notAdd){if(title){str=str||"";if(!notAdd){Post.fn.items++;Post.fn.dlgItems[Post.fn.items]={title:title,str:str,isSuccess:isSuccess,self:this}}tool.cover();config.modal.title.html(title);config.modal.text.html(str);tool.switchDialogType("display");tool.dialogDisplay();config.modal.icon[(isSuccess?"add":"remove")+"Class"]("icon-ok");config.modal.btn.text(isSuccess?
"\u786e\u5b9a":"\u5173\u95ed")}return this},loading:function(title){title=title||"\u52a0\u8f7d\u4e2d...";this.alert(title);tool.switchDialogType("loading");return this},errorAlert:function(title){title=title||"\u52a0\u8f7d\u5931\u8d25...";this.alert(title);tool.switchDialogType("error");return this},uncover:function(){tool.uncover()},close:function(time,func){if(time)tool.mytimer=setTimeout(function(){tool.dialogClose()},time);else tool.dialogClose();if(typeof func=="function")func();return this}};
manage.fn.constructor=manage;Post=function(url,data,callback,type,opts){opts=tool.getOpts(opts);var _self=this,_opts={"type":type,"url":url+(/\?/.test(url)?"&":"?")+(new Date).getTime(),"data":data,"beforeSend":function(xhr){if(opts.header)for(var a in opts.header)xhr[a]=opts.header[a]},"success":function(rtn){if(typeof rtn=="string")rtn=$.parseJSON(rtn);if(!--_self.items)tool.uncover();for(var i=opts.errors.length;i--;)if(opts.errors[i](rtn)!==undefined)return false;if(callback)callback(rtn)},"error":function(rtn){},
dataType:"json",timeout:opts.timeout};this.items++;if(config.displayLoading)tool.cover();$.ajax(_opts)};Post.fn=Post.prototype;Post.fn.dlgItems={};Post.fn.items=0;tool={cover:function(){config.modal.cover.css({"height":$(document.body).height()}).show()},uncover:function(){config.modal.cover.hide()},getOpts:function(opts){return!opts||typeof opts!=="object"?$.extend(config):function(opts){opts.timeout=opts.timeout||config.timeout;if(opts.header)opts.header=$.extend(config.header,opts.header);return opts}(opts)},
dialogClose:function(){if(tool.mytimer)clearTimeout(tool.mytimer);var _dlg;if(!--Post.fn.items){tool.uncover();config.modal.dialog.hide()}else{_dlg=Post.fn.dlgItems[Post.fn.items];_dlg.self.alert(_dlg.title,_dlg.str,_dlg.isSuccess,true)}},dialogEvent:function(){config.modal.dialog.find("[func='close']").on("click",function(){tool.dialogClose()})},switchDialogType:function(type){var _type={display:1,error:1,loading:1};type=_type[type]?type:"error";config.modal.dialog.find(".c-post-dialog-content").each(function(){var _$this=
$(this);if(_$this.attr("func")==type)_$this.removeClass("hidden");else _$this.addClass("hidden")})},getDialog:function(){var _modal=$("<div class='c-post-dialog'>\t\t\t\t\t\t\t\t<div class='c-post-dialog-container'>\t\t\t\t\t\t\t\t\t<div class='c-post-dialog-cover'></div>\t\t\t\t\t\t\t\t\t<div class='c-post-dialog-body'>\t\t\t\t\t\t\t\t\t\t<h3><span class='close' func='close'>x</span></h3>\t\t\t\t\t\t\t\t\t\t<div class='c-post-dialog-content hidden' func='display'>\t\t\t\t\t\t\t\t\t\t\t<p class='c-post-dialog-icon f-center border-btm'><i func='icon'></i><span func='title'>\u8f93\u5165\u9519\u8bef</span></p>\t\t\t\t\t\t\t\t\t\t\t<p class='f-center m-btm-medium' func='text'></p>\t\t\t\t\t\t\t\t\t\t\t<p class='f-center'><a class='ui-btn-medium  ui-btn-default ui-button secondary large' func='close'>\u5173\u95ed</a></p>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='c-post-dialog-content s-loading space hidden' func='loading'>\t\t\t\t\t\t\t\t\t\t\t<span func='title'>\u4fe1\u606f\u6b63\u5728\u4fdd\u6301\u4e2d...</span>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class='c-post-dialog-content s-warning space hidden' func='error'>\t\t\t\t\t\t\t\t\t\t\t<span><b func='title'>\u52a0\u8f7d\u5931\u8d25~</b><a href='javascript:;'' role='button' rel='nofollow'>\u7acb\u5373\u5237\u65b0</a></span>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t</div>");
$(document.body).append(_modal);return _modal},dialogDisplay:function(){var _$body=$(document.body),_w;config.modal.cover.height(_$body.height());config.modal.dialog.show();if(!config.modal.display){config.modal.display=true;_w=_$body.width();config.modal.dialog.css({left:(_w-config.modal.dialog.width())/2,top:"50%",marginTop:-config.modal.dialog.outerHeight()/2})}},getCover:function(){var _modal=$("<div>",{"class":"c-post-cover"});$(document.body).append(_modal);return _modal},config:function(){config=
{modal:{cover:tool.getCover(),dialog:tool.getDialog(),display:0,title:0,text:0,btn:0,icon:0},header:{},errors:[],timeout:2E4,displayLoading:false};config.modal.title=config.modal.dialog.find("[func='title']");config.modal.text=config.modal.dialog.find("[func='text']");config.modal.icon=config.modal.dialog.find("[func='icon']");config.modal.btn=config.modal.dialog.find(".ui-button");tool.dialogEvent()}};tool.config();module.exports.post=new manage},{}],7:[function(require,module,exports){function Dropdown(opts){this.settings=
opts;this.eventNamespace="."+this.settings.namespace;this.$dropdown=opts.dropdown;this.$options=this.$dropdown.find(this.settings.selector.options);this.$items=this.$dropdown.find(this.settings.selector.item);this.$text=this.$dropdown.find(this.settings.selector.text);this.$input=this.$dropdown.find(this.settings.selector.input);this.$otherDropdowns=$(this.settings.selector.dropdown).not(this.$dropdown);this.placeholder=this.$text.text()||this.$dropdown.attr("data-placeholder");this.$searchInput=
this.$dropdown.find("."+this.settings.searchBar.inputClass);this.$searchButton=this.$dropdown.find("."+this.settings.searchBar.buttonClass);this.$dropdown.data("smartdropdown",this);this.init()}Dropdown.prototype={init:function(){this.setItemsHeight();this.intent();this.$dropdown.on("mousedown",$.proxy(this.hideOthers,this));this.$dropdown.on("click",$.proxy(this.toggle,this));this.bindItemsEvents();this.bindSearchEvents()},bindItemsEvents:function(){this.$items.on("click",$.proxy(this.itemClick,
this))},unbindItemsEvents:function(){this.$items.off("click")},bindSearchEvents:function(){if(this.settings.searchBar.show)this.$searchButton.on("click",$.proxy(this.search,this))},unbindSearchEvents:function(){if(this.settings.searchBar.show)this.$searchButton.off("click")},setItemsHeight:function(maxCount){maxCount=maxCount||(this.settings.maxCount||10);if(this.$items.length>0){var maxHeight=this.$items.first().outerHeight()*maxCount;var isIE6=/msie 6/i.test(navigator.userAgent);if(isIE6)this.$options.css("height",
maxHeight);else this.$options.css("maxHeight",maxHeight)}},toggle:function(e){e.stopPropagation();var $target=$(e.target),$parent=$target.parent(),isDropdownTarget=!$target.hasClass("smartdropdown-searchbar")&&!$parent.hasClass("smartdropdown-searchbar");if(isDropdownTarget)if(!this.$dropdown.hasClass(this.settings.className.disabled))if(this.$dropdown.hasClass(this.settings.className.visible))this.hideDropdown.call(this,e);else this.showDropdown.call(this,e)},intent:function(){$(document).on("click"+
this.eventNamespace,$.proxy(this.hideDropdown,this))},showDropdown:function(e){e.stopPropagation();if(this.settings.searchBar.show){this.$searchInput.val("");this.$options.find(".nodata").remove();this.$items.show()}this.$dropdown.addClass(this.settings.className.visible);$.proxy(this.settings.onShow,this)()},hideDropdown:function(e){e.stopPropagation();this.$dropdown.removeClass(this.settings.className.visible);$.proxy(this.settings.onHide,this)()},hideOthers:function(e){e.stopPropagation();this.$otherDropdowns.filter("."+
this.settings.className.visible).removeClass(this.settings.className.visible)},enable:function(){this.$dropdown.removeClass(this.settings.className.disabled)},disable:function(){this.$dropdown.addClass(this.settings.className.disabled)},show:function(){this.$dropdown.addClass(this.settings.className.visible);$.proxy(this.settings.onShow,this)()},hide:function(){this.$dropdown.removeClass(this.settings.className.visible);$.proxy(this.settings.onHide,this)()},itemClick:function(e){e.stopPropagation();
var $me=$(e.target),selectedValue;this.hide();selectedValue=$me.attr("data-value");this.selected(selectedValue)},render:function(items){this.reset();this.append(items);if(this.settings.searchBar.show){var searchHtml=this.getSearchBarTemplate();this.$items.first().before(searchHtml);this.$searchInput=this.$dropdown.find("."+this.settings.searchBar.inputClass);this.$searchButton=this.$dropdown.find("."+this.settings.searchBar.buttonClass);this.bindSearchEvents()}},append:function(items){var $item,item,
text,value,list=[];if(items)for(var i=0;i<items.length;i++){$item=$(document.createElement(this.settings.itemTagName)).addClass(this.settings.className.item);item=items[i];text=item.text;value=item.value;if(text!==undefined)$item.attr("data-text",text).text(item.text);if(value!==undefined)$item.attr("data-value",value);if(this.settings.setItemTitle&&text)$item.attr("title",text);list.push($item)}if(list&&list.length>0){this.$options.append(list);this.$items=this.$dropdown.find(this.settings.selector.item);
this.setItemsHeight();this.unbindItemsEvents();this.bindItemsEvents()}},setPlaceholder:function(text){this.$text.text(text)},getItem:function(value){var $selectedItem=this.$items.filter('[data-value="'+value+'"]');if($selectedItem.length===0)$selectedItem=this.$items.filter('[data-text="'+value+'"]');return $selectedItem},getValue:function(){var $item=this.$items.filter("."+this.settings.className.selected);if($item.length>0)return $item.attr("data-value");else return""},selected:function(value,silence){var $selectedItem=
this.getItem(value),selectedText,selectedValue,oldValue;this.$items.removeClass(this.settings.className.selected);if($selectedItem.length>0){this.$items.removeClass(this.settings.className.selected);$selectedItem.addClass(this.settings.className.selected);selectedText=$selectedItem.attr("data-text");selectedValue=$selectedItem.attr("data-value");this.setPlaceholder(selectedText);oldValue=this.$dropdown.data("oldvalue");this.$dropdown.data("oldvalue",selectedValue);this.$input.val(selectedValue);if(!silence&&
selectedValue!==oldValue)$.proxy(this.settings.onChange,this.settings.dropdown)(selectedValue,selectedText)}},reset:function(){this.unbindSearchEvents();this.unbindItemsEvents();this.$options.empty();this.$input.val("");this.$items=this.$options.find(this.settings.selector.item);if(this.placeholder)this.$text.text(this.placeholder)},search:function(e){e.stopPropagation();var resultLength=0;var value=$.trim(this.$searchInput.val());if(value==="")this.$items.show();else this.$items.each(function(){var $me=
$(this);var itemText=$me.attr("data-text");if(itemText.indexOf(value)>-1)$me.show();else{$me.hide();resultLength++}});this.$options.find(".nodata").remove();if(this.$items.length>0&&this.$items.length===resultLength)this.$options.append('<div class="nodata smartdropdown-searchbar">'+this.settings.searchBar.emptyText+"</div>")},getSearchBarTemplate:function(){var tpl='<div class="ddl-search smartdropdown-searchbar"><input type="text" placeholder="{0}" class="{1}" /><button class="{2}">{3}</button></div>';
return tpl.replace("{0}",this.settings.searchBar.placeholder).replace("{1}",this.settings.searchBar.inputClass).replace("{2}",this.settings.searchBar.buttonClass).replace("{3}",this.settings.searchBar.buttonText)}};$.fn.smartdropdown=function(){var args=Array.prototype.slice.call(arguments,0);var opts,result;this.each(function(){var _this=$(this),method,smartDropdown;if(typeof args.length===0||typeof args[0]==="object"){opts=args.length===0?$.fn.smartdropdown.defaults:$.extend(true,{},$.fn.smartdropdown.defaults,
args[0]);opts.dropdown=_this;new Dropdown(opts)}else if(typeof args[0]==="string"){method=args[0];smartDropdown=_this.data("smartdropdown");if(smartDropdown===undefined)return;if(smartDropdown[method]===undefined)$.error("Invalid method name "+method+" to smartdropdown plugin");else result=smartDropdown[method].apply(smartDropdown,args.slice(1))}else $.error("Invalid arguments to smartdropdown plugin: "+args)});return result===undefined?this:result};$.fn.smartdropdown.defaults={namespace:"smartdropdown",
itemTagName:"div",maxCount:10,setItemTitle:true,onChange:function(value,text){},onShow:function(){},onHide:function(){},selector:{options:".options",item:".options > .item",text:"> .text",input:'> input[type="hidden"]',dropdown:".smartdropdown"},className:{item:"item",disabled:"disabled",visible:"visible",selected:"selected"},searchBar:{show:false,inputClass:"search-input",buttonClass:"search-btn",buttonText:"\u641c\u7d22",placeholder:"",emptyText:"\u6ca1\u6709\u6570\u636e"}}},{}],8:[function(require,
module,exports){(function(){var root=this;var previousUnderscore=root._;var ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype;var push=ArrayProto.push,slice=ArrayProto.slice,concat=ArrayProto.concat,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty;var nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind;var _=function(obj){if(obj instanceof _)return obj;if(!(this instanceof _))return new _(obj);this._wrapped=obj};if(typeof exports!==
"undefined"){if(typeof module!=="undefined"&&module.exports)exports=module.exports=_;exports._=_}else root._=_;_.VERSION="1.7.0";var createCallback=function(func,context,argCount){if(context===void 0)return func;switch(argCount==null?3:argCount){case 1:return function(value){return func.call(context,value)};case 2:return function(value,other){return func.call(context,value,other)};case 3:return function(value,index,collection){return func.call(context,value,index,collection)};case 4:return function(accumulator,
value,index,collection){return func.call(context,accumulator,value,index,collection)}}return function(){return func.apply(context,arguments)}};_.iteratee=function(value,context,argCount){if(value==null)return _.identity;if(_.isFunction(value))return createCallback(value,context,argCount);if(_.isObject(value))return _.matches(value);return _.property(value)};_.each=_.forEach=function(obj,iteratee,context){if(obj==null)return obj;iteratee=createCallback(iteratee,context);var i,length=obj.length;if(length===
+length)for(i=0;i<length;i++)iteratee(obj[i],i,obj);else{var keys=_.keys(obj);for(i=0,length=keys.length;i<length;i++)iteratee(obj[keys[i]],keys[i],obj)}return obj};_.map=_.collect=function(obj,iteratee,context){if(obj==null)return[];iteratee=_.iteratee(iteratee,context);var keys=obj.length!==+obj.length&&_.keys(obj),length=(keys||obj).length,results=Array(length),currentKey;for(var index=0;index<length;index++){currentKey=keys?keys[index]:index;results[index]=iteratee(obj[currentKey],currentKey,
obj)}return results};var reduceError="Reduce of empty array with no initial value";_.reduce=_.foldl=_.inject=function(obj,iteratee,memo,context){if(obj==null)obj=[];iteratee=createCallback(iteratee,context,4);var keys=obj.length!==+obj.length&&_.keys(obj),length=(keys||obj).length,index=0,currentKey;if(arguments.length<3){if(!length)throw new TypeError(reduceError);memo=obj[keys?keys[index++]:index++]}for(;index<length;index++){currentKey=keys?keys[index]:index;memo=iteratee(memo,obj[currentKey],
currentKey,obj)}return memo};_.reduceRight=_.foldr=function(obj,iteratee,memo,context){if(obj==null)obj=[];iteratee=createCallback(iteratee,context,4);var keys=obj.length!==+obj.length&&_.keys(obj),index=(keys||obj).length,currentKey;if(arguments.length<3){if(!index)throw new TypeError(reduceError);memo=obj[keys?keys[--index]:--index]}while(index--){currentKey=keys?keys[index]:index;memo=iteratee(memo,obj[currentKey],currentKey,obj)}return memo};_.find=_.detect=function(obj,predicate,context){var result;
predicate=_.iteratee(predicate,context);_.some(obj,function(value,index,list){if(predicate(value,index,list)){result=value;return true}});return result};_.filter=_.select=function(obj,predicate,context){var results=[];if(obj==null)return results;predicate=_.iteratee(predicate,context);_.each(obj,function(value,index,list){if(predicate(value,index,list))results.push(value)});return results};_.reject=function(obj,predicate,context){return _.filter(obj,_.negate(_.iteratee(predicate)),context)};_.every=
_.all=function(obj,predicate,context){if(obj==null)return true;predicate=_.iteratee(predicate,context);var keys=obj.length!==+obj.length&&_.keys(obj),length=(keys||obj).length,index,currentKey;for(index=0;index<length;index++){currentKey=keys?keys[index]:index;if(!predicate(obj[currentKey],currentKey,obj))return false}return true};_.some=_.any=function(obj,predicate,context){if(obj==null)return false;predicate=_.iteratee(predicate,context);var keys=obj.length!==+obj.length&&_.keys(obj),length=(keys||
obj).length,index,currentKey;for(index=0;index<length;index++){currentKey=keys?keys[index]:index;if(predicate(obj[currentKey],currentKey,obj))return true}return false};_.contains=_.include=function(obj,target){if(obj==null)return false;if(obj.length!==+obj.length)obj=_.values(obj);return _.indexOf(obj,target)>=0};_.invoke=function(obj,method){var args=slice.call(arguments,2);var isFunc=_.isFunction(method);return _.map(obj,function(value){return(isFunc?method:value[method]).apply(value,args)})};_.pluck=
function(obj,key){return _.map(obj,_.property(key))};_.where=function(obj,attrs){return _.filter(obj,_.matches(attrs))};_.findWhere=function(obj,attrs){return _.find(obj,_.matches(attrs))};_.max=function(obj,iteratee,context){var result=-Infinity,lastComputed=-Infinity,value,computed;if(iteratee==null&&obj!=null){obj=obj.length===+obj.length?obj:_.values(obj);for(var i=0,length=obj.length;i<length;i++){value=obj[i];if(value>result)result=value}}else{iteratee=_.iteratee(iteratee,context);_.each(obj,
function(value,index,list){computed=iteratee(value,index,list);if(computed>lastComputed||computed===-Infinity&&result===-Infinity){result=value;lastComputed=computed}})}return result};_.min=function(obj,iteratee,context){var result=Infinity,lastComputed=Infinity,value,computed;if(iteratee==null&&obj!=null){obj=obj.length===+obj.length?obj:_.values(obj);for(var i=0,length=obj.length;i<length;i++){value=obj[i];if(value<result)result=value}}else{iteratee=_.iteratee(iteratee,context);_.each(obj,function(value,
index,list){computed=iteratee(value,index,list);if(computed<lastComputed||computed===Infinity&&result===Infinity){result=value;lastComputed=computed}})}return result};_.shuffle=function(obj){var set=obj&&obj.length===+obj.length?obj:_.values(obj);var length=set.length;var shuffled=Array(length);for(var index=0,rand;index<length;index++){rand=_.random(0,index);if(rand!==index)shuffled[index]=shuffled[rand];shuffled[rand]=set[index]}return shuffled};_.sample=function(obj,n,guard){if(n==null||guard){if(obj.length!==
+obj.length)obj=_.values(obj);return obj[_.random(obj.length-1)]}return _.shuffle(obj).slice(0,Math.max(0,n))};_.sortBy=function(obj,iteratee,context){iteratee=_.iteratee(iteratee,context);return _.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iteratee(value,index,list)}}).sort(function(left,right){var a=left.criteria;var b=right.criteria;if(a!==b){if(a>b||a===void 0)return 1;if(a<b||b===void 0)return-1}return left.index-right.index}),"value")};var group=function(behavior){return function(obj,
iteratee,context){var result={};iteratee=_.iteratee(iteratee,context);_.each(obj,function(value,index){var key=iteratee(value,index,obj);behavior(result,value,key)});return result}};_.groupBy=group(function(result,value,key){if(_.has(result,key))result[key].push(value);else result[key]=[value]});_.indexBy=group(function(result,value,key){result[key]=value});_.countBy=group(function(result,value,key){if(_.has(result,key))result[key]++;else result[key]=1});_.sortedIndex=function(array,obj,iteratee,
context){iteratee=_.iteratee(iteratee,context,1);var value=iteratee(obj);var low=0,high=array.length;while(low<high){var mid=low+high>>>1;if(iteratee(array[mid])<value)low=mid+1;else high=mid}return low};_.toArray=function(obj){if(!obj)return[];if(_.isArray(obj))return slice.call(obj);if(obj.length===+obj.length)return _.map(obj,_.identity);return _.values(obj)};_.size=function(obj){if(obj==null)return 0;return obj.length===+obj.length?obj.length:_.keys(obj).length};_.partition=function(obj,predicate,
context){predicate=_.iteratee(predicate,context);var pass=[],fail=[];_.each(obj,function(value,key,obj){(predicate(value,key,obj)?pass:fail).push(value)});return[pass,fail]};_.first=_.head=_.take=function(array,n,guard){if(array==null)return void 0;if(n==null||guard)return array[0];if(n<0)return[];return slice.call(array,0,n)};_.initial=function(array,n,guard){return slice.call(array,0,Math.max(0,array.length-(n==null||guard?1:n)))};_.last=function(array,n,guard){if(array==null)return void 0;if(n==
null||guard)return array[array.length-1];return slice.call(array,Math.max(array.length-n,0))};_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,n==null||guard?1:n)};_.compact=function(array){return _.filter(array,_.identity)};var flatten=function(input,shallow,strict,output){if(shallow&&_.every(input,_.isArray))return concat.apply(output,input);for(var i=0,length=input.length;i<length;i++){var value=input[i];if(!_.isArray(value)&&!_.isArguments(value)){if(!strict)output.push(value)}else if(shallow)push.apply(output,
value);else flatten(value,shallow,strict,output)}return output};_.flatten=function(array,shallow){return flatten(array,shallow,false,[])};_.without=function(array){return _.difference(array,slice.call(arguments,1))};_.uniq=_.unique=function(array,isSorted,iteratee,context){if(array==null)return[];if(!_.isBoolean(isSorted)){context=iteratee;iteratee=isSorted;isSorted=false}if(iteratee!=null)iteratee=_.iteratee(iteratee,context);var result=[];var seen=[];for(var i=0,length=array.length;i<length;i++){var value=
array[i];if(isSorted){if(!i||seen!==value)result.push(value);seen=value}else if(iteratee){var computed=iteratee(value,i,array);if(_.indexOf(seen,computed)<0){seen.push(computed);result.push(value)}}else if(_.indexOf(result,value)<0)result.push(value)}return result};_.union=function(){return _.uniq(flatten(arguments,true,true,[]))};_.intersection=function(array){if(array==null)return[];var result=[];var argsLength=arguments.length;for(var i=0,length=array.length;i<length;i++){var item=array[i];if(_.contains(result,
item))continue;for(var j=1;j<argsLength;j++)if(!_.contains(arguments[j],item))break;if(j===argsLength)result.push(item)}return result};_.difference=function(array){var rest=flatten(slice.call(arguments,1),true,true,[]);return _.filter(array,function(value){return!_.contains(rest,value)})};_.zip=function(array){if(array==null)return[];var length=_.max(arguments,"length").length;var results=Array(length);for(var i=0;i<length;i++)results[i]=_.pluck(arguments,i);return results};_.object=function(list,
values){if(list==null)return{};var result={};for(var i=0,length=list.length;i<length;i++)if(values)result[list[i]]=values[i];else result[list[i][0]]=list[i][1];return result};_.indexOf=function(array,item,isSorted){if(array==null)return-1;var i=0,length=array.length;if(isSorted)if(typeof isSorted=="number")i=isSorted<0?Math.max(0,length+isSorted):isSorted;else{i=_.sortedIndex(array,item);return array[i]===item?i:-1}for(;i<length;i++)if(array[i]===item)return i;return-1};_.lastIndexOf=function(array,
item,from){if(array==null)return-1;var idx=array.length;if(typeof from=="number")idx=from<0?idx+from+1:Math.min(idx,from+1);while(--idx>=0)if(array[idx]===item)return idx;return-1};_.range=function(start,stop,step){if(arguments.length<=1){stop=start||0;start=0}step=step||1;var length=Math.max(Math.ceil((stop-start)/step),0);var range=Array(length);for(var idx=0;idx<length;idx++,start+=step)range[idx]=start;return range};var Ctor=function(){};_.bind=function(func,context){var args,bound;if(nativeBind&&
func.bind===nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError("Bind must be called on a function");args=slice.call(arguments,2);bound=function(){if(!(this instanceof bound))return func.apply(context,args.concat(slice.call(arguments)));Ctor.prototype=func.prototype;var self=new Ctor;Ctor.prototype=null;var result=func.apply(self,args.concat(slice.call(arguments)));if(_.isObject(result))return result;return self};return bound};_.partial=function(func){var boundArgs=
slice.call(arguments,1);return function(){var position=0;var args=boundArgs.slice();for(var i=0,length=args.length;i<length;i++)if(args[i]===_)args[i]=arguments[position++];while(position<arguments.length)args.push(arguments[position++]);return func.apply(this,args)}};_.bindAll=function(obj){var i,length=arguments.length,key;if(length<=1)throw new Error("bindAll must be passed function names");for(i=1;i<length;i++){key=arguments[i];obj[key]=_.bind(obj[key],obj)}return obj};_.memoize=function(func,
hasher){var memoize=function(key){var cache=memoize.cache;var address=hasher?hasher.apply(this,arguments):key;if(!_.has(cache,address))cache[address]=func.apply(this,arguments);return cache[address]};memoize.cache={};return memoize};_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)};_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)))};_.throttle=function(func,wait,options){var context,args,
result;var timeout=null;var previous=0;if(!options)options={};var later=function(){previous=options.leading===false?0:_.now();timeout=null;result=func.apply(context,args);if(!timeout)context=args=null};return function(){var now=_.now();if(!previous&&options.leading===false)previous=now;var remaining=wait-(now-previous);context=this;args=arguments;if(remaining<=0||remaining>wait){clearTimeout(timeout);timeout=null;previous=now;result=func.apply(context,args);if(!timeout)context=args=null}else if(!timeout&&
options.trailing!==false)timeout=setTimeout(later,remaining);return result}};_.debounce=function(func,wait,immediate){var timeout,args,context,timestamp,result;var later=function(){var last=_.now()-timestamp;if(last<wait&&last>0)timeout=setTimeout(later,wait-last);else{timeout=null;if(!immediate){result=func.apply(context,args);if(!timeout)context=args=null}}};return function(){context=this;args=arguments;timestamp=_.now();var callNow=immediate&&!timeout;if(!timeout)timeout=setTimeout(later,wait);
if(callNow){result=func.apply(context,args);context=args=null}return result}};_.wrap=function(func,wrapper){return _.partial(wrapper,func)};_.negate=function(predicate){return function(){return!predicate.apply(this,arguments)}};_.compose=function(){var args=arguments;var start=args.length-1;return function(){var i=start;var result=args[start].apply(this,arguments);while(i--)result=args[i].call(this,result);return result}};_.after=function(times,func){return function(){if(--times<1)return func.apply(this,
arguments)}};_.before=function(times,func){var memo;return function(){if(--times>0)memo=func.apply(this,arguments);else func=null;return memo}};_.once=_.partial(_.before,2);_.keys=function(obj){if(!_.isObject(obj))return[];if(nativeKeys)return nativeKeys(obj);var keys=[];for(var key in obj)if(_.has(obj,key))keys.push(key);return keys};_.values=function(obj){var keys=_.keys(obj);var length=keys.length;var values=Array(length);for(var i=0;i<length;i++)values[i]=obj[keys[i]];return values};_.pairs=function(obj){var keys=
_.keys(obj);var length=keys.length;var pairs=Array(length);for(var i=0;i<length;i++)pairs[i]=[keys[i],obj[keys[i]]];return pairs};_.invert=function(obj){var result={};var keys=_.keys(obj);for(var i=0,length=keys.length;i<length;i++)result[obj[keys[i]]]=keys[i];return result};_.functions=_.methods=function(obj){var names=[];for(var key in obj)if(_.isFunction(obj[key]))names.push(key);return names.sort()};_.extend=function(obj){if(!_.isObject(obj))return obj;var source,prop;for(var i=1,length=arguments.length;i<
length;i++){source=arguments[i];for(prop in source)if(hasOwnProperty.call(source,prop))obj[prop]=source[prop]}return obj};_.pick=function(obj,iteratee,context){var result={},key;if(obj==null)return result;if(_.isFunction(iteratee)){iteratee=createCallback(iteratee,context);for(key in obj){var value=obj[key];if(iteratee(value,key,obj))result[key]=value}}else{var keys=concat.apply([],slice.call(arguments,1));obj=new Object(obj);for(var i=0,length=keys.length;i<length;i++){key=keys[i];if(key in obj)result[key]=
obj[key]}}return result};_.omit=function(obj,iteratee,context){if(_.isFunction(iteratee))iteratee=_.negate(iteratee);else{var keys=_.map(concat.apply([],slice.call(arguments,1)),String);iteratee=function(value,key){return!_.contains(keys,key)}}return _.pick(obj,iteratee,context)};_.defaults=function(obj){if(!_.isObject(obj))return obj;for(var i=1,length=arguments.length;i<length;i++){var source=arguments[i];for(var prop in source)if(obj[prop]===void 0)obj[prop]=source[prop]}return obj};_.clone=function(obj){if(!_.isObject(obj))return obj;
return _.isArray(obj)?obj.slice():_.extend({},obj)};_.tap=function(obj,interceptor){interceptor(obj);return obj};var eq=function(a,b,aStack,bStack){if(a===b)return a!==0||1/a===1/b;if(a==null||b==null)return a===b;if(a instanceof _)a=a._wrapped;if(b instanceof _)b=b._wrapped;var className=toString.call(a);if(className!==toString.call(b))return false;switch(className){case "[object RegExp]":case "[object String]":return""+a===""+b;case "[object Number]":if(+a!==+a)return+b!==+b;return+a===0?1/+a===
1/b:+a===+b;case "[object Date]":case "[object Boolean]":return+a===+b}if(typeof a!="object"||typeof b!="object")return false;var length=aStack.length;while(length--)if(aStack[length]===a)return bStack[length]===b;var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&("constructor"in a&&("constructor"in b&&!(_.isFunction(aCtor)&&(aCtor instanceof aCtor&&(_.isFunction(bCtor)&&bCtor instanceof bCtor))))))return false;aStack.push(a);bStack.push(b);var size,result;if(className==="[object Array]"){size=
a.length;result=size===b.length;if(result)while(size--)if(!(result=eq(a[size],b[size],aStack,bStack)))break}else{var keys=_.keys(a),key;size=keys.length;result=_.keys(b).length===size;if(result)while(size--){key=keys[size];if(!(result=_.has(b,key)&&eq(a[key],b[key],aStack,bStack)))break}}aStack.pop();bStack.pop();return result};_.isEqual=function(a,b){return eq(a,b,[],[])};_.isEmpty=function(obj){if(obj==null)return true;if(_.isArray(obj)||(_.isString(obj)||_.isArguments(obj)))return obj.length===
0;for(var key in obj)if(_.has(obj,key))return false;return true};_.isElement=function(obj){return!!(obj&&obj.nodeType===1)};_.isArray=nativeIsArray||function(obj){return toString.call(obj)==="[object Array]"};_.isObject=function(obj){var type=typeof obj;return type==="function"||type==="object"&&!!obj};_.each(["Arguments","Function","String","Number","Date","RegExp"],function(name){_["is"+name]=function(obj){return toString.call(obj)==="[object "+name+"]"}});if(!_.isArguments(arguments))_.isArguments=
function(obj){return _.has(obj,"callee")};if(typeof/./!=="function")_.isFunction=function(obj){return typeof obj=="function"||false};_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj))};_.isNaN=function(obj){return _.isNumber(obj)&&obj!==+obj};_.isBoolean=function(obj){return obj===true||(obj===false||toString.call(obj)==="[object Boolean]")};_.isNull=function(obj){return obj===null};_.isUndefined=function(obj){return obj===void 0};_.has=function(obj,key){return obj!=null&&hasOwnProperty.call(obj,
key)};_.noConflict=function(){root._=previousUnderscore;return this};_.identity=function(value){return value};_.constant=function(value){return function(){return value}};_.noop=function(){};_.property=function(key){return function(obj){return obj[key]}};_.matches=function(attrs){var pairs=_.pairs(attrs),length=pairs.length;return function(obj){if(obj==null)return!length;obj=new Object(obj);for(var i=0;i<length;i++){var pair=pairs[i],key=pair[0];if(pair[1]!==obj[key]||!(key in obj))return false}return true}};
_.times=function(n,iteratee,context){var accum=Array(Math.max(0,n));iteratee=createCallback(iteratee,context,1);for(var i=0;i<n;i++)accum[i]=iteratee(i);return accum};_.random=function(min,max){if(max==null){max=min;min=0}return min+Math.floor(Math.random()*(max-min+1))};_.now=Date.now||function(){return(new Date).getTime()};var escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};var unescapeMap=_.invert(escapeMap);var createEscaper=function(map){var escaper=function(match){return map[match]};
var source="(?:"+_.keys(map).join("|")+")";var testRegexp=RegExp(source);var replaceRegexp=RegExp(source,"g");return function(string){string=string==null?"":""+string;return testRegexp.test(string)?string.replace(replaceRegexp,escaper):string}};_.escape=createEscaper(escapeMap);_.unescape=createEscaper(unescapeMap);_.result=function(object,property){if(object==null)return void 0;var value=object[property];return _.isFunction(value)?object[property]():value};var idCounter=0;_.uniqueId=function(prefix){var id=
++idCounter+"";return prefix?prefix+id:id};_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/;var escapes={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"};var escaper=/\\|'|\r|\n|\u2028|\u2029/g;var escapeChar=function(match){return"\\"+escapes[match]};_.template=function(text,settings,oldSettings){if(!settings&&oldSettings)settings=oldSettings;settings=_.defaults({},settings,_.templateSettings);var matcher=
RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g");var index=0;var source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){source+=text.slice(index,offset).replace(escaper,escapeChar);index=offset+match.length;if(escape)source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'";else if(interpolate)source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'";else if(evaluate)source+=
"';\n"+evaluate+"\n__p+='";return match});source+="';\n";if(!settings.variable)source="with(obj||{}){\n"+source+"}\n";source="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";try{var render=new Function(settings.variable||"obj","_",source)}catch(e){e.source=source;throw e;}var template=function(data){return render.call(this,data,_)};var argument=settings.variable||"obj";template.source="function("+argument+"){\n"+source+"}";return template};
_.chain=function(obj){var instance=_(obj);instance._chain=true;return instance};var result=function(obj){return this._chain?_(obj).chain():obj};_.mixin=function(obj){_.each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];push.apply(args,arguments);return result.call(this,func.apply(_,args))}})};_.mixin(_);_.each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=
this._wrapped;method.apply(obj,arguments);if((name==="shift"||name==="splice")&&obj.length===0)delete obj[0];return result.call(this,obj)}});_.each(["concat","join","slice"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result.call(this,method.apply(this._wrapped,arguments))}});_.prototype.value=function(){return this._wrapped};if(typeof define==="function"&&define.amd)define("underscore",[],function(){return _})}).call(this)},{}],9:[function(require,module,exports){var Post=
require("./../lib/post.js");var dialog=require("./../ui/dialog.js");var confirm=require("./../ui/confirm.js");require("./../lib/panel.js");document.domain="vip.com";var tool,post=Post.post,config;tool={data:{},ev:{destory:function(){if(config.dlgPendding||config.uploading)return;config.panel.hide();tool.ev.clean()},save:function(){if(!config.originImgPath){dialog.show({type:"info",msg:"\u8bf7\u5148\u9009\u62e9\u56fe\u7247...",mask:false,buttons:[{text:"\u786e\u5b9a",type:"primary",event:function(){this.remove()}}]});
return}else if(!cropPos.w||!cropPos.h){dialog.show({type:"info",msg:"\u8bf7\u9009\u62e9\u5934\u50cf\u533a\u57df...",mask:false,buttons:[{text:"\u786e\u5b9a",type:"primary",event:function(){this.remove()}}]});return}else if(config.dlgPendding||config.uploading)return;tool.ev.setUploadForm();tool.ev.doUpload()},clean:function(){cropPos=null;iframeWindow=null;$(".jcrop-holder").remove();config.$panel.find(".avatar-border img").attr("src",$(".J_hd_avatar img").attr("src")).removeAttr("style");config.originImg=
null;config.originImgPath="";config.originImgW=0;config.originImgH=0;config.dlgPendding=null;config.uploading=false;window.navigator.__avatarUploadCallback=null;tool.ev.cleanUploadForm()},cleanUploadForm:function(){$(config.iframeWindow.document.getElementById("_avatarUploadInputFile_")).val("");$(config.iframeWindow.document.getElementById("image_x")).val("");$(config.iframeWindow.document.getElementById("image_y")).val("");$(config.iframeWindow.document.getElementById("image_w")).val("");$(config.iframeWindow.document.getElementById("image_h")).val("")},
setUploadForm:function(){var MIN_LENGTH=200,image_x=Math.max(cropPos.x,0),image_y=Math.max(cropPos.y,0),image_w=Math.max(cropPos.w,0),image_h=Math.max(cropPos.h,0);if(image_x+image_w>config.originImgW){image_w=Math.max(config.originImgW-image_x,MIN_LENGTH);image_x=config.originImgW-image_w}if(image_y+image_h>config.originImgH){image_h=Math.max(config.originImgH-image_y,MIN_LENGTH);image_y=config.originImgH-image_h}image_w=image_h=Math.min(image_w,image_h);$(config.iframeWindow.document.getElementById("image_x")).val(image_x);
$(config.iframeWindow.document.getElementById("image_y")).val(image_y);$(config.iframeWindow.document.getElementById("image_w")).val(image_w);$(config.iframeWindow.document.getElementById("image_h")).val(image_h)},uploadCallback:function(result){config.uploading=false;config.dlgPendding.remove();config.dlgPendding=null;var json=JSON.parse(result),msg;if(json&&json.code!=200){if(json.code==500)msg="\u4e0a\u4f20\u5931\u8d25 \u8bf7\u7a0d\u540e\u91cd\u8bd5";else if(json.code==400)msg=json.msg;else msg=
json.msg.replace(/\+/g,"");dialog.show({type:"error",msg:msg,mask:false,buttons:[{text:"\u786e\u5b9a",type:"primary",event:function(){this.remove();tool.ev.clean()}}]});return}window.navigator.__avatarUploadCallback=null;dialog.show({type:"success",msg:"\u4e0a\u4f20\u6210\u529f\uff0c\u5ba1\u6838\u901a\u8fc7\u540e\u4f1a\u6b63\u5e38\u663e\u793a",mask:false,autoClose:3,buttons:[{text:"\u786e\u5b9a",type:"primary",event:function(){this.remove()}}],closeFunction:function(){$(".J_hd_avatar img").attr("src",
json.data.url);$(".J_avatar_fali_tip").addClass("hidden");config.panel.hide();tool.ev.clean()}})},doUpload:function(){config.dlgPendding=dialog.show({type:"info",msg:"\u5934\u50cf\u4e0a\u4f20\u4e2d\uff0c\u8bf7\u7a0d\u5019...",mask:false,parent:config.$panel,buttons:[{text:"\u786e\u5b9a",type:"primary",event:function(){config.dlgPendding=null;this.remove()}}]});window.navigator.__avatarUploadCallback=tool.ev.uploadCallback;config.uploading=true;config.iframeWindow.document.getElementById("_avatarUploadForm_").submit()},
handleUserIcon:function(){var _$file;if(config.panel){config.$panel.find(".avatar-border img").attr("src",$(".J_hd_avatar img").attr("src")).removeAttr("style");return config.panel.show()}tool.ui.getUserIconPanel(function(){_$file=$(config.iframeWindow.document.getElementById("_avatarUploadInputFile_"));_$file.change(function(){var clipW=200,clipH=200,maxSize=370,JCROP_CONF={aspectRatio:1,bgFade:true,bgOpacity:0.2,boxWidth:maxSize,boxHeight:maxSize,setSelect:[0,0,clipW,clipH],minSize:[200,200],"onSelect":function(axis){cropPos=
{x:parseInt(axis.x)||0,y:parseInt(axis.y)||0,x2:parseInt(axis.x2)||0,y2:parseInt(axis.y2)||0,w:parseInt(axis.w)||0,h:parseInt(axis.h)||0};tool.ui.zoom(axis)}};var fnPicFix=function(api,base64Img){var w=config.originImgW,h=config.originImgH,clipW=200,clipH=200;var callback=function(){if(base64Img)config.$panel.find(".avatar-border").html('<img src="'+base64Img+'">');else if(config.originImgPath){var preview=$("<img>");preview[0].style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod = 'scale',src='"+
config.originImgPath+"')";config.$panel.find(".avatar-border").html(preview)}api.animateTo([(w-clipW)/2,(h-clipH)/2,(w+clipW)/2,(h+clipH)/2]);api.setSelect([(w-clipW)/2,(h-clipH)/2,(w+clipW)/2,(h+clipH)/2])};var maxSide=w>h?w:h;var reduce=maxSide>370?maxSide/370:1;var neww=w/reduce,newh=h/reduce;config.$panel.find(".jcrop-holder").animate({marginLeft:(370-neww)/2+5,marginTop:(370-newh)/2+5},200,function(){setTimeout(callback,200)})};var fnAdapImgSize=function(){var w=config.originImgW,h=config.originImgH,
maxSide=w>h?w:h,reduce=maxSide>370?maxSide/370:1,neww=w/reduce,newh=h/reduce;config.originImg.css({"width":neww,"height":newh,"zoom":"1","display":"block","overflow":"hidden"})};if(_$file.val()){config.originImgPath=_$file.val();if(config.hasFileReader){var files=_$file[0].files[0];var MAX_SIZE=5*1024*1024;if(files.size>MAX_SIZE){dialog.show({type:"error",msg:"\u56fe\u7247\u5927\u5c0f\u4e0d\u8d85\u8fc7 5M",mask:false,parent:config.$panel,autoClose:3,buttons:[{text:"\u786e\u5b9a",type:"primary",event:function(){this.remove()}}]});
tool.ev.clean();return false}var reader=new FileReader;reader.onload=function(e){config.originImg=$("<img>").appendTo(config.$panel.find(".avatar-left").empty()).attr("src",e.target.result).load(function(){config.originImgW=config.originImg.width();config.originImgH=config.originImg.height();if(config.originImgW<200||config.originImgH<200){dialog.show({type:"error",msg:"\u56fe\u7247\u6700\u5c0f\u9ad8\u5bbd\u4e0d\u80fd\u5c0f\u4e8e200",mask:false,buttons:[{text:"\u786e\u5b9a",type:"primary",event:function(){this.remove()}}]});
tool.ev.clean();return false}config.originImg.Jcrop(JCROP_CONF,function(){var api=this;fnPicFix(api,e.target.result,null)})})};reader.readAsDataURL(_$file[0].files[0])}else{var imgPath=_$file.val();if(imgPath.indexOf("fakepath")>-1){_$file[0].select();imgPath=config.iframeWindow.document.selection.createRange().text}config.originImgPath=imgPath;var orgpic=$("<img>").appendTo("body").css("display","none");orgpic[0].style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod = 'image',src='"+
config.originImgPath+"')";var orgW=orgpic.width(),orgH=orgpic.height();orgpic.remove();if(orgW<200||orgH<200){dialog.show({type:"error",msg:"\u56fe\u7247\u6700\u5c0f\u9ad8\u5bbd\u4e0d\u80fd\u5c0f\u4e8e200",mask:false,buttons:[{text:"\u786e\u5b9a",type:"primary",event:function(){this.remove()}}]});tool.ev.clean();return false}config.originImgW=orgW;config.originImgH=orgH;var maxSide=orgW>orgH?orgW:orgH,reduce=maxSide>370?maxSide/370:1,neww=orgW/reduce+"px",newh=orgH/reduce+"px";config.originImg=$("<img>").appendTo(config.$panel.find(".avatar-left").empty());
config.originImg.css({width:orgW,height:orgH});config.originImg[0].style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod = 'scale',src='"+config.originImgPath+"')";var api=$.Jcrop(config.originImg,JCROP_CONF);fnPicFix(api,null,_$file.val(),neww,newh)}}});$("#userIcon-update").off("click").on("click",function(){_$file.click()});$("#userIcon-close").off("click").on("click",function(){tool.ev.destory()});$("#userIcon-save").off("click").on("click",function(){tool.ev.save()})})},
initEvents:function(){$(".J_hd_avatar").on("click",function(){tool.ev.handleUserIcon()});if(navigator.userAgent.toLowerCase().indexOf("safari")!=-1&&navigator.userAgent.toLowerCase().indexOf("chrome")=="-1")$(".J_hd_avatar").addClass("safariHack")}},ui:{zoom:function(pos){var w=config.originImgW,h=config.originImgH,smallW,smallH,smallX,smallY;if(w>=h){smallW=Math.floor(85/pos.w*w);smallH=Math.floor(h/w*smallW)}else{smallH=Math.floor(85/pos.w*h);smallW=Math.floor(w/h*smallH)}smallX=Math.floor(smallW*
pos.x/w);smallY=Math.floor(smallH*pos.y/h);if(config.hasFileReader)config.$panel.find(".avatar-preview img").css({"width":smallW,"height":smallH,"margin-top":-smallY,"margin-left":-smallX});else{var preview=$("<img>");preview.css({"width":smallW,"height":smallH,"margin-top":-smallY,"margin-left":-smallX});preview[0].style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod = 'scale',src='"+config.originImgPath+"')";config.$panel.find(".avatar-border").html(preview)}},getUserIconPanel:function(func){var _panel=
new Panel("userIcon",'<div class="dlg-avatar">                                                        <h4 class="title">                                                            <i>\u81ea\u5b9a\u4e49\u5934\u50cf</i>                                                        </h4>                                                        <div class="btn-upload">                                                            <iframe src="//myi.vip.com/avatar_upload_success" frameborder="0" name="avatar_upload_iframe"                                                                    id="avatar_upload_iframe"></iframe>                                                            <button role="button" class="ui-btn-medium  ui-btn-default u-button" id="userIcon-update" mars_sead="103|2|3|2">\u4e0a\u4f20\u5934\u50cf</button>                                                            <span>\u652f\u6301\u5927\u5c0f\u4e0d\u8d85\u8fc7 5M \u7684 jpg\u3001png \u56fe\u7247</span>                                                        </div>                                                        <div class="avatar-area clearfix">                                                            <div class="avatar-left"></div>                                                            <div class="avatar-right">                                                                <span>\u9884\u89c8</span>                                                                <div class="avatar-preview">                                                                    <div class="avatar-border"><img src="'+
$(".J_hd_avatar img").attr("src")+'"></div>                                                                </div>                                                            </div>                                                        </div>                                                        <p class="avatar-btns"><a class="ui-btn-medium  ui-btn-primary u-button" id="userIcon-save" mars_sead="103|2|3|3">\u4fdd\u5b58</a><a class="ui-btn-medium  ui-btn-default" id="userIcon-close" mars_sead="103|2|3|4">\u53d6\u6d88</a></p>                                                    </div>',
612,580),_iframe;config.panel=_panel;_panel.show();config.$panel=$("#userIcon");_iframe=document.getElementById("avatar_upload_iframe");config.$panel.find(".close").attr("mars_sead","103|2|3|5");$(_iframe).load(function(){config.iframeWindow=document.getElementById("avatar_upload_iframe").contentWindow;func()})}},config:function(){config={panel:0,$panel:0,originImg:0,originImgPath:"",hasFileReader:typeof window.FileReader==="function",originImgW:0,originImgH:0,iframeWindow:0,dlgPendding:0,uploading:false};
post.error(function(rtn){var _url;rtn.code==rtn.code==200?0:rtn.code;if(rtn.code==302){_url=encodeURIComponent(window.location.href);window.location.href=rtn.data.replace(/src=.*/,"")+_url}})}};tool.config();tool.ev.initEvents()},{"./../lib/panel.js":5,"./../lib/post.js":6,"./../ui/confirm.js":10,"./../ui/dialog.js":11}],10:[function(require,module,exports){var dialog=require("./dialog");module.exports.show=function(options){options=options||{};var settings={type:"help",buttons:[{text:"\u786e\u5b9a",
type:"primary",click:function(){this.remove();if(typeof options.onAccept==="function")options.onAccept()}},{text:"\u53d6\u6d88",focus:true,click:function(){this.remove();if(typeof options.onCancel==="function")options.onCancel()}}],autoClose:false};settings.onCloseButton=function(){if(typeof options.onCancel==="function")options.onCancel()};settings.title=options.title;settings.msg=options.msg||"\u786e\u5b9a\u8fdb\u884c\u8be5\u64cd\u4f5c\u5417\uff1f";settings.parent=options.parent||"body";settings.width=
options.width||300;settings.height=options.height||0;if("mask"in options)settings.mask=options.mask;dialog.show(settings)}},{"./dialog":11}],11:[function(require,module,exports){var defaults={title:false,type:"info",msg:"\u5bf9\u4e0d\u8d77\uff0c\u7cfb\u7edf\u7e41\u5fd9\u8bf7\u7a0d\u540e\u5c1d\u8bd5\u3002",exClassName:"",buttons:[],closeFunction:function(){},autoClose:false,size:"small",mask:true,maskColor:"#000000"};function show(options){if(typeof options==="string")options={msg:options};options=
$.extend(true,{},defaults,options);options.icon=options.type||"warning";if(options.title&&typeof options.title!=="string")options.title="\u6e29\u99a8\u63d0\u793a";var _autoClose=options.autoClose?'<div class="auto-close">'+options.autoClose+"\u79d2\u540e\u81ea\u52a8\u5173\u95ed</div>":"";var _icon,_type;switch(options.type){case "warning":_icon="&#xe603;";_type="sigh";break;case "success":_icon="&#xe602;";_type="success";break;default:_icon="&#xe607;";_type="info"}var _html='<div class="f-text-center"><span class="i-dialog-icon vipFont if-'+
_type+' if-size-32">'+_icon+'</span><span class="i-dialog-txt">'+options.msg+"</span>"+_autoClose+"</div>";var dialog=$.Dialog({model:options.mask,opacity:0.5,title:options.title,size:"small",elStyle:options.exClassName,content:_html,button:options.buttons,closeEvent:function(){options.closeFunction&&options.closeFunction();this.remove()}}).open();if(options.autoClose){if(typeof options.autoClose!=="number")options.autoClose=3;var remainSecond=options.autoClose;var countdown=function(){if(remainSecond>
0){dialog.getElem(".auto-close").text(remainSecond+"\u79d2\u540e\u81ea\u52a8\u5173\u95ed");remainSecond-=1;setTimeout(function(){countdown()},1E3)}else dialog.close()};countdown()}return dialog}module.exports.show=show},{}]},{},[1]);
